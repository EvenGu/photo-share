<!---
Photo displays one photo with caption, tags, comment
as well as the containing album and the owner
--->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Photo</title>
<link rel="stylesheet" href="css/home.css">
</head>

<body>

<nav class="navbar navbar-default">
  <div class="container"> 
    <div class="navbar-header">
      <ul class="nav navbar-nav">
      	<li class="navbar-left"><a class="navbar-brand" href="home.html">Home</a></li>        
        {% if not user %}
        <li class="navbar-right active"><a class="navbar-default" href="register.html">Register</a></li>
        <li class="navbar-right"><a class="navbar-default" href="login.html">Login</a></li>
        {% else %}
        <li class="navbar-right"><a class="navbar-default" href="{{ url_for('profile') }}">My Profile</a></li>
        <li class="navbar-right"><a class="navbar-default" href="{{ url_for('logout') }}">Logout</a></li>
        {% endif %}        
      </ul> 
	</div>
  </div>
</nav>

{% if user %}
<section>
  <div class="jumbotron text-center">
    <div class="container">
      <div class="row">
        <div class="col-md12">
        {% if name %}
          <h1>Hello {{Name}}</h1>
        {% endif %}
        </div>
      </div>
      <div class="row">
      	<div class="col-lg-12 text-center">
        	<form role="search" action="/photoSearch" method = "POST">
            	<div style="margin-bottom:10px">
        		<input type="text" class="form-control " placeholder="Search">
                </div>
                <div class="row">
            		<label style="width:20px">tag</label>
  						<input type="radio" class="radio-inline" name="search" id="tag" value="t">
  					<label style="width:30px" for="user">user</label>
  						<input type="radio" class="radio-inline" name="search" id="user" value="u">
          		</div>
        		<button type="search" class="btn btn-primary btn-md">Search</button>       
     		</form>	
      	</div>      	
      </div>
    </div>
  </div>
</section>

<section>
  <div class="container">
    <div class="row">
    {% if photos %}
	
	<ul>{
    	{% for photo in photos %}
	        <li><a href="{{url_for('photo')}}?pid={{photos[1]}}&photouid={{photos[3]}}">
                <img src="data:image/png;base64, {{photo[0]}}"/></a><br>{{photos[3]}}<br>
                caption: {{photo[2]}} photo id: {{photo[2]}}
	            <a href="{{url_for('delete')}}?pid={{photo[1]}}&photouid={{photo[3]}}&aid={{photo[4]}}">Delete {{photo[2]}}</a>
		        <br>
	        </li>
 	    {% endfor %}
	</ul>
	
{% if photos %}
<h2>Here's your photos</h2>
   <ul>
   {% for photo in photos %}
       <li><a href = '/albums?photo_id={{photo[2]}}'>caption: {{photo[1]}} photo id: {{photo[2]}}</a></li>
       <li><img src='/upload/{{ photo[2] }}' /></li>
   {% endfor %}
   <img src="http://img.mukewang.com/52da54ed0001ecfa04120172.jpg">
   </ul>
{% endif %}
	<a href="{{url_for('albums')}}?aid={{photos[0][4]}}&userid={{photos[0][3]}}">Back to Album</a>
	





{% endif %}

{% if photo %}
	
	<img src='data:image/png;base64, {{photo[0][0]}}'/><br>{{photo[0][2]}}
	<a href="{{url_for('albums')}}?aid={{photo[0][4]}}">Back to Album</a>
	<br>
	{% if tags %}
		Tags: 
		{% for tag in tags %}
			<br>
			{{tag[3]}}
			<br>
			<a href="{{url_for('photo')}}?word={{tag[3]}}&usertagid={{tag[1]}}&pid={{tag[2]}}">View my photos/</a>
			<a href="{{url_for('photo')}}?word={{tag[3]}}&pid={{tag[2]}}">View all photos</a>

		{% endfor %}
		

	{% endif %}
	<br>
	{% if likes %}
		{% for like in likes %}
			{{like[1]}}
		{% endfor %}
		&nbsp;{{count}}
		people have liked the photo
	{% endif %}
	<br>
	<a href="{{url_for('photo')}}?pid={{photo[0][1]}}&userid={{photo[0][3]}}">Like!</a>


	<br>
	<form method="post" action="/photo">
		Comment:<label for="comments"></label>
        <input type="text" name="comment" /><br />
        <input type="submit" name="comment" value="Submit">
        <input type="hidden" name="pid" value="{{photo[0][1]}}">
        <input type="hidden" name="photouid" value="{{photo[0][3]}}">
	</form>

	{% if comments %}
		{% for comment in comments %}
			{% if not anonymous %}
				<a href="{{url_for('users')}}?uid={{comment[0]}}">{{comment[1]}}</a>
				:&nbsp;{{comment[2]}}
			{% else %}
				Anonymous:&nbsp;{{comment[2]}}
			{% endif %}
			
		{% endfor %}
	{% endif %}
{% endif %}

</section>
</body>

</html>